### 资产管理云化架构0.1



#### 现状及痛点分析

- 当前资产管理单体架构，oracle数据库，无法做到集中管理
- 数据量庞大，业务统计，报表汇总流程复杂。
- 行业云化趋势，系统无法满足。



---



#### 蓝图

- 初步实现资产管理系统的云化方案
- 实现资产管理系统的多租户模式（公有云）
- 可简单实施部署定制化系统（非云/私有云）

#### 系统指标

- 峰值支持**百万级**并发请求（pv:100W/s | uv:100W/s）
- 单接口响应速度**300ms**以下
- 核心卡片数据10亿+ 并做到快速检索
- 业务数据（折旧、盘点）支持100亿+ 的数据量级存储，及快速查询。

#### 建设难点

- 单体架构-》微服务架构迁移
- 卡片数据，折旧数据，变动表数据量级巨大，且几何倍数增长
- 个别业务（折旧，盘点）波峰明显，数据提取，数据审核的并发问题。要支持百万级并发。
- PB级非结构化业务数据的维护（业务文件，图片）

- PB级非结构化系统数据的维护（业务日志）



- **卡片问题**
  - 1.卡片表设计按照大类进行拆表是否合理、卡片多版本、痕迹、回退设计
  - 2.卡片自定义字段存储实现
  - 3.卡片明细多条件检索如果实现秒级响应
  - 4.卡片汇总、专项查询如何实现秒级响应



- **计提折旧业务问题**
  - 1.折旧单数据量庞大，尤其是子表，与卡片数持平，单据的存储如何实现
  - 2.折旧明细数据量庞大，折旧明细表的数据存储如何实现
  - 3.集中大规模生成折旧数据时，服务器的软硬件要求高（并发场景下，磁盘大规模数据写入性能问题）
  - 4.折旧月度查询如何实现秒级响应
  - 5.资产月折旧查询如何实现秒级响应
  - 6.计提折旧功能本身的性能如何提升



- **资产盘点业务问题**
  - 1.如何实现亿级数据的快速过滤  
  - 2.初始化盘点任务时，大量卡片数据如何高效的初始化到盘点子表 
  - 3.用户在查询盘点明细时，如何快速统计各项盘点数据：未盘点、盘盈、盘亏、无盈亏、进度等 
  - 4.高级查询如何快速响应  
  - 5.高并发场景下的大型excel导入导出如何做到数据安全性和高效率



- **组织机构树权限问题**
  - 1.数据存储设计，如何满足现有业务需求，做到冗余度小、直观性强、节点增删改查要做到操作高效
  - 2.模糊搜索如何实现秒级响应
  - 3.单位树多版本设计，多版本下业务数据查询
  - 4.数据同步实现方案，如何保证同步后数据的正确性
  - 5.权限对接，含权限的业务数据筛选如何保证效率



- **大数据量初始及审核效率（数据割接问题）**
  - 1.审核形式，SQL校验还是走模型校验；以及审核的定义、来源或者生成方式如何设计
  - 2.审核类型，基础数据、主数据、组织机构数据、业务数据，数据类型不同，审核规则也不同
  - 3.初始进来的数据如何与对应的业务模型做关联
  - 4.审核后不通过的数据如何处理
  - 5.大批量的审核，如何保证效率问题



- **报表填报问题**
  - 1.卡片表、变动表、折旧表、盘点单等数据量大，数据提取汇总时间执行耗时太长
  - 2.填报时间短，填报单位多，短时间内报表提取、运算、汇总、校验并发量高、资源消耗大，需要保证系统稳定性及提升效率
  - 3.层层汇总、批量校验效率问题
  - 4.跨租户报表数据的上报汇总及查看实现。



- **微服务设计原则问题**
  - 1.拆分粒度，资产系统功能模块复杂繁多，微服务拆大了相当于没拆，拆的太小管理起来不方便
  - 2.拆分边界清晰、分工明确。各业务模块之间都存在密切的关系，如何保证拆分出来的服务之间分工独立
  - 3.大数据量、高并发的环境下如何保证服务的稳定性
  - 4.不同微服务间的调用，如何保证操作的原子性
  - 大集中环境下实现不停服务更新程序



- **多租户问题**
  - 1.定制化拆分：定制化租户如何进行拆分
  - 2.查询分析：上级租户如何查询统计下级租户数据
  - 3.数据上报：下级租户如何将数据上报给上级租户
  - 流程提交：下级租户可将流程提交到上级租



- **元数据问题**
  - 1.参数关系：租户间的元数据关系如何进行管理，管理策略是什么样的
  - 2.参数升级：上级租户升级之后，下级租户的参数升级如何即保留个性化又保留上级参数新特性



- **运维和部署**
  - 1.租户之间的数据隔离方案选择
  - 2.新增租户时如何快速的安装部署
  - 3.标准版租户和各种个性化版版本租户的统一管理
  - 4.全国各版本租户的系统统一更新的容错及时效问题
  - 5.如何低成本的保证各租户及租户通用微服务的高可用和高性能
  - 6.通用微服务分布式部署时CAP原则的C（一致性）和A（可用性）如何保证
  - 7.云部署的数据备份级别及方案
  - 8.资源利用率最高的部署方案
  - 9.如何做到自动化运维



- **私有云安全问题**
  - 1.运维账号及权限管理问题
  - 2.运维管理接口暴露的安全性保障
  - 3.运维记录或日志的管理及预警
  - 4.其他云安全方面的经验